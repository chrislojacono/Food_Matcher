'use strict';

const _smallRequest = require('small-request');
const _defaultRequestFilters = require('@tonybadguy/call-me-maybe/lib/default-request-filters');
const _defaultResponseFilters = require('@tonybadguy/call-me-maybe/lib/default-response-filters');
const _processFilters = require('@tonybadguy/call-me-maybe/lib/process-filters');

const send = (request, requestFilters, responseFilters) => {
  
  if(!requestFilters){
    requestFilters = _defaultRequestFilters();
  }
  
  if(!responseFilters){
    responseFilters = _defaultResponseFilters();
  }
  
  return _smallRequest.send(_processFilters(request, requestFilters)).then(response => {
    return _processFilters(response, responseFilters);
  });
};

module.exports = send;
